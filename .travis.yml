language: c
  
matrix:
  include:
    - name: "OSX - GCC"
      os: osx
      compiler:
        - gcc
      before_install:
        - export PATH="$(pwd)/build:${PATH}"
        - brew update
        - brew install ninja
        - brew install meson
    - name: "OSX - CLANG"
      os: osx
      compiler:
        - clang
      before_install:
        - export PATH="$(pwd)/build:${PATH}"
        - brew update
        - brew install ninja
        - brew install meson
    - name: "Linux - GCC"
      os: linux
      dist: trusty
      sudo: yes
      compiler: gcc
      before_install:
        - export PATH="$(pwd)/build:${PATH}"
        - sh -c "$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh)"
        - PATH="/home/linuxbrew/.linuxbrew/bin:$PATH"
        - brew update
        - brew install ninja
        - brew install meson
    - name: "Linux - CLANG"
      os: linux
      dist: trusty
      sudo: yes
      compiler: clang
      before_install:
        - export PATH="$(pwd)/build:${PATH}"
        - sh -c "$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh)"
        - PATH="/home/linuxbrew/.linuxbrew/bin:$PATH"
        - brew update
        - brew install ninja
        - brew install meson
    - name: "Windows - CLANG"
      os: windows
      compiler: clang
      before_install:
        - export PATH="$(pwd)/build:${PATH}"
        - sh -c "$(curl -fsSL https://raw.githubusercontent.com/Linuxbrew/install/master/install.sh)"
        - echo "eval \$($(brew --prefix)/bin/brew shellenv)" >>~/.profile
        - test -d ~/.linuxbrew && eval $(~/.linuxbrew/bin/brew shellenv)
        - test -d /home/linuxbrew/.linuxbrew && eval $(/home/linuxbrew/.linuxbrew/bin/brew shellenv)
        - test -r ~/.bash_profile && echo "eval \$($(brew --prefix)/bin/brew shellenv)" >>~/.bash_profile
        - brew update
        - brew install ninja
        - brew install meson
  
# Build scripts
# The same on all platforms
script:
  - meson builddir
  - ninja -C builddir
  - ninja -C builddir test
  - ls builddir
